## Super-Real Time Facial Landmark Detection and Shape Fitting By Deep Regression of Shape Model Parameters

> arXiv 2019

### Abstract

​	我们提出一个高效的landmark detection方法，结合了深度网络和现有基于模型（model-based）的拟合算法。受到现有基于模型的方法启发（如，active shape），我们使用landmark位置的PCA来对面部landmark建模。我们不是迭代优化模型参数，而是使用一个新的层将PCA包括到深度神经网络中。网络前传预测模型参数，因此使得landmark detection可以一秒几百帧。我们的结构可以直接端到端训练基于模型的landmark detection方法，神经网络可以用来预测模型参数而不需要迭代优化。

![f1](images\f1.png)

### Introduction and Previous Work

​	landmark detection 对于面部和解剖结构一直是关键的研究领域。在深度学习方法之前，优化驱动的生成式方法表现最好。知名的方法有ASMs，AAMs，CLMs。它们尽管在细节上不同，但它们的核心都是参数化的统计landmark形状模型，通过迭代的调整参数来拟合形状。这些方法最近被基于机器学习的算法所超越，包括深度对齐网络，stacked hourglass 网络以及HyperFace框架（不仅可以landmark detection，还提供了完整的端到端方案以及后续分析）。尽管这些方法比之前提到的经典方法更准确也更鲁棒，但很少一部分基于学习的方法和常规方法能达到实时（30fps）。最值得一提的快速landmark detection方法是[8]和[9]（毫秒级）。这些方法也应用了统计点分布模型，但对最优模型参数的回归是在一次前传中执行而不是迭代优化。

​	我们也用了回归，并使用深度网络来预测参数。该方法结合了回归方法的速度以及神经网络的鲁棒性。[10]中使用神经网络来预测PCA参数，用于医学数据。但其不包含形状模型，需要在网络之外计算模型实例。在我们提出的方法中，基于PCA的landmark定位是网络的一部分，因此可以端到端训练，并且达到更快的预测速度。[11]中将PCA包括进网络来分割医学器官，但其是为医疗数据所设计，并包含了一些特殊步骤。在我们的方法中，我们将点分布模型压缩到专有的网络层，因此可以在现有的结构中使用它。此外，我们提出一个轻量级全卷积特征提取网络，可以快速进行面部landmark检测。最后，我们包含了全局平移，缩放和旋转参数来移除landmark坐标全局平移的影响，因此可以使用专门预测局部位移的模型。

### Methods

#### 2.1 Feature extraction

​	网络包含特征提取阶段和一个PCA结合层来将计算出的形状特征向量与预测参数相乘，形成最终的landmark位置。我们提出的特征提取阶段接收人脸作为输入，其回归输出包括PCA参数预测值和均匀的（homogeneus）全局变换参数。使用一系列巻积层实现。此外，我们使用了沿图像两个方向的空间分离卷积来进一步减少参数量。表1展示了详细的层情况。

![t1](images\t1.png)

#### 2.2 PCA layer with homogeneus transform

![f2](images\f2.png)

​	PCA 层设计如图2。该层接收全局homogeneus 变换参数（一个尺度参数，一个旋转参数和两个平移参数）和每个PCA特征向量的一个输入。特征向量在预处理阶段从训练数据中计算，然后在训练前送入网络。特征向量使用其特征值来归一化以保证一致性，因此提升了收敛速度。他们在训练时不改变。此外，PCA计算的平均形状加载到网络，其权重固定为1。

​	为了计算landmark 位置，将特征向量与其对应的权值相乘，将结果与平均形状线性组合，得到局部坐标下的形状实例。随后，landmark被转换到一致的坐标，从回归的全局变换参数中计算变换矩阵并应用于局部landmark位置。分离局部位移和全局变换使得基于PCA的点分布模型专门用于描述局部性质变换，从而以更少的参数来包括更多的相关形状变换，同时增强了该层预测large全局位移的能力。该层返回最终的landmark坐标。

​	因为PCA层的设计是通用的，因此它可以用于任何可由PCA描述的数据分布。

#### 2.3 Data Preparation and Network training

​	图像在landmark附近裁剪，并resize到统一大小（224x224）。接着，计算landmark坐标的PCA，并将特征向量提供的平均形状和选择的形状变化个数存储在网络的PCA层中。形状变化的个数可以是任意个。因为我们明确的从PCA中移除了旋转变换，在应用PCA前，训练图像的旋转通过水平对齐眼中心来归一化。接着，通过在增广阶段引入旋转。

​	网络输入包含裁剪的图像，由特征提取和PCA层来处理。网络端到端训练，并使用L1或MSE作为损失。

### Experiments and Results

![f3](images\f3.png) ![f4](images\f4.png)

​	分析了形状参数个数的影响，如图3所示，在参数超过15个以后不会大幅提升准确度。误差度量是归一化的点到点误差[15]，计算每个landmark的均方根误差。这种方法允许有效的比较landmark detection算法，无论输入图像的大小和局部位移，如头部的姿态等。